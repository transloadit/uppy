{"version":3,"sources":["../../../src/plugins/Instagram/index.js"],"names":["Plugin","require","Provider","View","module","exports","core","opts","type","id","title","stateId","icon","Instagram","host","provider","authProvider","files","onAuth","bind","render","defaultOptions","install","view","viewType","setState","instagram","authenticated","folders","directories","activeRow","filterInput","isSearchVisible","target","mount","uninstall","unmount","updateState","getFolder","isFolder","item","getItemData","getItemIcon","images","thumbnail","url","getItemSubList","subItems","data","forEach","subItem","carousel_media","i","index","created_time","newSubItem","carousel_id","push","getItemName","getMimeType","getItemId","getItemRequestPath","suffix","isNaN","getItemModifiedDate","getItemThumbnailUrl","getNextPagePath","getState","length","state"],"mappings":"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","file":"index.js","sourcesContent":["const html = require('yo-yo')\nconst Plugin = require('../Plugin')\n\nconst Provider = require('../../Provider')\n\nconst View = require('../../generic-provider-views')\n\nmodule.exports = class Instagram extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.type = 'acquirer'\n    this.id = 'Instagram'\n    this.title = 'Instagram'\n    this.stateId = 'instagram'\n    this.icon = () => html`\n      <svg aria-hidden=\"true\" class=\"UppyIcon UppyModalTab-icon\" width=\"28\" height=\"28\" viewBox=\"0 0 512 512\">\n        <path\n          d=\"M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z\"/>\n        <path\n          d=\"M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z\"/>\n        <circle cx=\"390.476\" cy=\"121.524\" r=\"30.23\"/>\n      </svg>\n    `\n\n    // writing out the key explicitly for readability the key used to store\n    // the provider instance must be equal to this.id.\n    this.Instagram = new Provider(core, {\n      host: this.opts.host,\n      provider: 'instagram',\n      authProvider: 'instagram'\n    })\n\n    this.files = []\n\n    this.onAuth = this.onAuth.bind(this)\n    // Visual\n    this.render = this.render.bind(this)\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n  }\n\n  install () {\n    this.view = new View(this, {\n      viewType: 'grid'\n    })\n    // Set default state for Google Drive\n    this.core.setState({\n      // writing out the key explicitly for readability the key used to store\n      // the plugin state must be equal to this.stateId.\n      instagram: {\n        authenticated: false,\n        files: [],\n        folders: [],\n        directories: [],\n        activeRow: -1,\n        filterInput: '',\n        isSearchVisible: false\n      }\n    })\n\n    const target = this.opts.target\n    if (target) {\n      this.mount(target, this)\n    }\n  }\n\n  uninstall () {\n    this.unmount()\n  }\n\n  onAuth (authenticated) {\n    this.view.updateState({authenticated})\n    if (authenticated) {\n      this.view.getFolder('recent')\n    }\n  }\n\n  isFolder (item) {\n    return false\n  }\n\n  getItemData (item) {\n    return item\n  }\n\n  getItemIcon (item) {\n    return html`<img width=\"100px\" src=${item.images.thumbnail.url}/>`\n  }\n\n  getItemSubList (item) {\n    const subItems = []\n    item.data.forEach((subItem) => {\n      if (subItem.carousel_media) {\n        subItem.carousel_media.forEach((i, index) => {\n          const { id, created_time } = subItem\n          const newSubItem = Object.assign({}, i, { id, created_time })\n          newSubItem.carousel_id = index\n          subItems.push(newSubItem)\n        })\n      } else {\n        subItems.push(subItem)\n      }\n    })\n    return subItems\n  }\n\n  getItemName (item) {\n    return ''\n  }\n\n  getMimeType (item) {\n    return item.type === 'video' ? 'video/mp4' : 'image/jpeg'\n  }\n\n  getItemId (item) {\n    return `${item.id}${item.carousel_id || ''}`\n  }\n\n  getItemRequestPath (item) {\n    const suffix = isNaN(item.carousel_id) ? '' : `?carousel_id=${item.carousel_id}`\n    return `${item.id}${suffix}`\n  }\n\n  getItemModifiedDate (item) {\n    return item.created_time\n  }\n\n  getItemThumbnailUrl (item) {\n    return item.images.thumbnail.url\n  }\n\n  getNextPagePath () {\n    const { files } = this.core.getState()[this.stateId]\n    return `recent?max_id=${this.getItemId(files[files.length - 1])}`\n  }\n\n  render (state) {\n    return this.view.render(state)\n  }\n}\n"]}