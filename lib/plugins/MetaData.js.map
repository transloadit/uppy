{"version":3,"sources":["../../src/plugins/MetaData.js"],"names":["Plugin","require","module","exports","core","opts","type","id","title","defaultOptions","handleFileAdded","bind","file","metaFields","fields","forEach","item","obj","value","updateMeta","addInitialMeta","setState","on","install","uninstall","off"],"mappings":";;;;;;;;;;AAAA,IAAMA,SAASC,QAAQ,UAAR,CAAf;;AAEA;;;;;AAKAC,OAAOC,OAAP;AAAA;;AACE,oBAAaC,IAAb,EAAmBC,IAAnB,EAAyB;AAAA;;AAAA,iDACvB,mBAAMD,IAAN,EAAYC,IAAZ,CADuB;;AAEvB,UAAKC,IAAL,GAAY,UAAZ;AACA,UAAKC,EAAL,GAAU,UAAV;AACA,UAAKC,KAAL,GAAa,WAAb;;AAEA;AACA,QAAMC,iBAAiB,EAAvB;;AAEA;AACA,UAAKJ,IAAL,GAAY,SAAc,EAAd,EAAkBI,cAAlB,EAAkCJ,IAAlC,CAAZ;;AAEA,UAAKK,eAAL,GAAuB,MAAKA,eAAL,CAAqBC,IAArB,OAAvB;AAZuB;AAaxB;;AAdH,qBAgBED,eAhBF,4BAgBmBE,IAhBnB,EAgByB;AAAA;;AACrB,QAAMC,aAAa,KAAKR,IAAL,CAAUS,MAA7B;;AAEAD,eAAWE,OAAX,CAAmB,UAACC,IAAD,EAAU;AAC3B,UAAMC,MAAM,EAAZ;AACAA,UAAID,KAAKT,EAAT,IAAeS,KAAKE,KAApB;AACA,aAAKd,IAAL,CAAUe,UAAV,CAAqBF,GAArB,EAA0BL,KAAKL,EAA/B;AACD,KAJD;AAKD,GAxBH;;AAAA,qBA0BEa,cA1BF,6BA0BoB;AAChB,QAAMP,aAAa,KAAKR,IAAL,CAAUS,MAA7B;;AAEA,SAAKV,IAAL,CAAUiB,QAAV,CAAmB;AACjBR,kBAAYA;AADK,KAAnB;;AAIA,SAAKT,IAAL,CAAUkB,EAAV,CAAa,iBAAb,EAAgC,KAAKZ,eAArC;AACD,GAlCH;;AAAA,qBAoCEa,OApCF,sBAoCa;AACT,SAAKH,cAAL;AACD,GAtCH;;AAAA,qBAwCEI,SAxCF,wBAwCe;AACX,SAAKpB,IAAL,CAAUqB,GAAV,CAAc,iBAAd,EAAiC,KAAKf,eAAtC;AACD,GA1CH;;AAAA;AAAA,EAAwCV,MAAxC","file":"MetaData.js","sourcesContent":["const Plugin = require('./Plugin')\n\n/**\n * Meta Data\n * Adds metadata fields to Uppy\n *\n */\nmodule.exports = class MetaData extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.type = 'modifier'\n    this.id = 'MetaData'\n    this.title = 'Meta Data'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.handleFileAdded = this.handleFileAdded.bind(this)\n  }\n\n  handleFileAdded (file) {\n    const metaFields = this.opts.fields\n\n    metaFields.forEach((item) => {\n      const obj = {}\n      obj[item.id] = item.value\n      this.core.updateMeta(obj, file.id)\n    })\n  }\n\n  addInitialMeta () {\n    const metaFields = this.opts.fields\n\n    this.core.setState({\n      metaFields: metaFields\n    })\n\n    this.core.on('core:file-added', this.handleFileAdded)\n  }\n\n  install () {\n    this.addInitialMeta()\n  }\n\n  uninstall () {\n    this.core.off('core:file-added', this.handleFileAdded)\n  }\n}\n"]}